{"version":3,"sources":["../../src/components/button.jsx"],"names":["StyledButton","styled","button","COLORS","SEASHELL_WHITE","props","top","bottom","Button","WebchatContext","webchatState","openWebview","sendPayload","sendInput","getThemeProperty","updateMessage","hover","setHover","theme","ButtonsDisabler","resolveDisabling","autoDisable","disabledStyle","handleClick","event","preventDefault","type","WEBCHAT","CUSTOM_PROPERTIES","buttonMessageType","INPUT","TEXT","webview","params","path","POSTBACK","data","String","children","text","payload","url","window","open","target","onClick","setDisabled","messageToUpdate","messagesJSON","filter","m","id","parentId","updatedMsg","getUpdatedMessage","getClassName","isCustom","renderBrowser","buttonStyle","CustomButton","customButton","e","buttonBgColor","buttonHoverBackground","CONCRETE_WHITE","buttonStyleBackground","SOLID_WHITE","buttonTextColor","buttonHoverTextColor","SOLID_BLACK","buttonStyleColor","color","backgroundColor","disabled","bottomRadius","renderNode","disabledProps","constructNodeProps","Webview","name","Error","serialize","buttonProps","title","withDisabledProps"],"mappings":"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","sourcesContent":["import { INPUT, params2queryString } from '@botonic/core'\nimport React, { useContext, useState } from 'react'\nimport styled from 'styled-components'\n\nimport { COLORS, WEBCHAT } from '../constants'\nimport { WebchatContext } from '../contexts'\nimport { renderComponent } from '../util/react'\nimport { ButtonsDisabler } from './buttons-disabler'\n\nconst StyledButton = styled.button`\n  display: flex;\n  width: 100%;\n  max-height: 80px;\n  font-size: 14px;\n  text-align: center;\n  align-content: center;\n  justify-content: center;\n  padding: 12px 32px;\n  font-family: inherit;\n  border: none;\n  border: 1px solid ${COLORS.SEASHELL_WHITE};\n  cursor: pointer;\n  outline: 0;\n  border-top-right-radius: ${props => props.top || '0px'};\n  border-top-left-radius: ${props => props.top || '0px'};\n  border-bottom-right-radius: ${props => props.bottom || '0px'};\n  border-bottom-left-radius: ${props => props.bottom || '0px'};\n  overflow: hidden;\n`\n\nexport const Button = props => {\n  const {\n    webchatState,\n    openWebview,\n    sendPayload,\n    sendInput,\n    getThemeProperty,\n    updateMessage,\n  } = useContext(WebchatContext)\n  const [hover, setHover] = useState(false)\n  const { theme } = webchatState\n  const { autoDisable, disabledStyle } = ButtonsDisabler.resolveDisabling(\n    webchatState.theme,\n    props\n  )\n  const handleClick = event => {\n    event.preventDefault()\n    const type = getThemeProperty(\n      WEBCHAT.CUSTOM_PROPERTIES.buttonMessageType,\n      INPUT.TEXT\n    )\n    if (props.webview) openWebview(props.webview, props.params)\n    else if (props.path) {\n      type == INPUT.POSTBACK\n        ? sendPayload(`__PATH_PAYLOAD__${props.path}`)\n        : sendInput({\n            type: INPUT.TEXT,\n            data: String(props.children),\n            text: String(props.children),\n            payload: `__PATH_PAYLOAD__${props.path}`,\n          })\n    } else if (props.payload) {\n      type == INPUT.POSTBACK\n        ? sendPayload(props.payload)\n        : sendInput({\n            type: INPUT.TEXT,\n            data: String(props.children),\n            text: String(props.children),\n            payload: props.payload,\n          })\n    } else if (props.url) {\n      window.open(props.url, props.target || '_blank')\n    }\n    if (props.onClick) props.onClick()\n    if (props.setDisabled) {\n      props.setDisabled(true)\n      const messageToUpdate = webchatState.messagesJSON.filter(\n        m => m.id == props.parentId\n      )[0]\n      const updatedMsg = ButtonsDisabler.getUpdatedMessage(messageToUpdate, {\n        autoDisable,\n        disabledStyle,\n      })\n      updateMessage(updatedMsg)\n    }\n  }\n\n  const getClassName = (isCustom = false) => {\n    if (isCustom) {\n      return 'button-custom'\n    }\n    if (props.payload) {\n      return 'button-payload'\n    }\n    if (props.url) {\n      return 'button-url'\n    }\n    if (props.webview) {\n      return 'button-webview'\n    }\n    if (props.path) {\n      return 'button-path'\n    }\n    return ''\n  }\n\n  const renderBrowser = () => {\n    const buttonStyle = getThemeProperty(WEBCHAT.CUSTOM_PROPERTIES.buttonStyle)\n    const CustomButton = getThemeProperty(\n      WEBCHAT.CUSTOM_PROPERTIES.customButton\n    )\n    if (CustomButton) {\n      return (\n        <div className={getClassName(true)} onClick={e => handleClick(e)}>\n          <CustomButton>{props.children}</CustomButton>\n        </div>\n      )\n    }\n\n    const buttonBgColor = hover\n      ? getThemeProperty(\n          WEBCHAT.CUSTOM_PROPERTIES.buttonHoverBackground,\n          COLORS.CONCRETE_WHITE\n        )\n      : getThemeProperty(\n          WEBCHAT.CUSTOM_PROPERTIES.buttonStyleBackground,\n          COLORS.SOLID_WHITE\n        )\n    const buttonTextColor = hover\n      ? getThemeProperty(\n          WEBCHAT.CUSTOM_PROPERTIES.buttonHoverTextColor,\n          COLORS.SOLID_BLACK\n        )\n      : getThemeProperty(\n          WEBCHAT.CUSTOM_PROPERTIES.buttonStyleColor,\n          COLORS.SOLID_BLACK\n        )\n\n    return (\n      <StyledButton\n        className={getClassName()}\n        theme={theme}\n        onMouseEnter={() => setHover(true)}\n        onMouseLeave={() => setHover(false)}\n        onClick={e => handleClick(e)}\n        style={{\n          ...buttonStyle,\n          color: buttonTextColor,\n          backgroundColor: buttonBgColor,\n          ...(props.disabled && autoDisable && disabledStyle),\n        }}\n        bottom={props.bottomRadius}\n      >\n        {props.children}\n      </StyledButton>\n    )\n  }\n\n  const renderNode = () => {\n    const disabledProps = ButtonsDisabler.constructNodeProps(props)\n    if (props.webview) {\n      const Webview = props.webview\n      let params = ''\n      if (props.params) params = params2queryString(props.params)\n      return (\n        <button url={`/webviews/${Webview.name}?${params}`} {...disabledProps}>\n          {props.children}\n        </button>\n      )\n    } else if (props.path) {\n      const payload = `__PATH_PAYLOAD__${props.path}`\n      return (\n        <button payload={payload} {...disabledProps}>\n          {props.children}\n        </button>\n      )\n    } else if (props.payload) {\n      return (\n        <button payload={props.payload} {...disabledProps}>\n          {props.children}\n        </button>\n      )\n    } else if (props.url) {\n      return (\n        <button url={props.url} target={props.target} {...disabledProps}>\n          {props.children}\n        </button>\n      )\n    } else if (props.onClick) {\n      return null\n    }\n    throw new Error('Button missing payload, path, webviews, url or onClick')\n  }\n\n  return renderComponent({ renderBrowser, renderNode })\n}\n\nButton.serialize = buttonProps => {\n  let payload = buttonProps.payload\n  if (buttonProps.path) payload = `__PATH_PAYLOAD__${buttonProps.path}`\n  return {\n    button: {\n      payload,\n      url: buttonProps.url,\n      target: buttonProps.target,\n      webview: buttonProps.webview && String(buttonProps.webview),\n      title: buttonProps.children && String(buttonProps.children),\n      ...ButtonsDisabler.withDisabledProps(buttonProps),\n    },\n  }\n}\n"],"file":"button.js"}