{"version":3,"sources":["../../src/components/buttons-disabler.js"],"names":["ButtonsDisabler","props","disabledProps","disabled","autodisable","undefined","disabledstyle","String","JSON","stringify","theme","getThemeProperty","autoDisable","WEBCHAT","CUSTOM_PROPERTIES","buttonAutoDisable","DEFAULTS","BUTTON_AUTO_DISABLE","computedDisabledStyle","buttonDisabledStyle","disabledStyle","BUTTON_DISABLED_STYLE","children","additionalProps","n","type","Button","updateButtons","node","setDisabled","parentId","messageToUpdate","updateMsgButton","button","data","elements","map","e","buttons"],"mappings":"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","sourcesContent":["import { Button } from '../components/button'\nimport { WEBCHAT } from '../constants'\nimport { isCarousel } from '../message-utils'\nimport { strToBool } from '../util/objects'\nimport { deepMapWithIndex } from '../util/react'\nimport { _getThemeProperty } from '../util/webchat'\n\nexport class ButtonsDisabler {\n  static constructBrowserProps(props) {\n    const disabledProps = { disabled: props.disabled }\n    if (props.autodisable !== undefined)\n      disabledProps.autodisable = strToBool(props.autodisable)\n    if (props.disabledstyle !== undefined)\n      disabledProps.disabledstyle = props.disabledstyle\n    return disabledProps\n  }\n  static constructNodeProps(props) {\n    const disabledProps = {}\n    if (props.autodisable !== undefined)\n      disabledProps.autodisable = String(props.autodisable)\n    if (props.disabledstyle !== undefined)\n      disabledProps.disabledstyle = JSON.stringify(props.disabledstyle)\n    return disabledProps\n  }\n\n  static withDisabledProps(props) {\n    return {\n      disabled: props.disabled,\n      autodisable: props.autodisable,\n      disabledstyle: props.disabledstyle,\n    }\n  }\n\n  static resolveDisabling(theme, props) {\n    const getThemeProperty = _getThemeProperty(theme)\n    const autoDisable =\n      props.autodisable !== undefined\n        ? props.autodisable\n        : getThemeProperty(\n            WEBCHAT.CUSTOM_PROPERTIES.buttonAutoDisable,\n            WEBCHAT.DEFAULTS.BUTTON_AUTO_DISABLE\n          )\n    const computedDisabledStyle =\n      props.disabledstyle !== undefined\n        ? props.disabledstyle\n        : getThemeProperty(WEBCHAT.CUSTOM_PROPERTIES.buttonDisabledStyle, {})\n\n    const disabledStyle = {\n      ...WEBCHAT.DEFAULTS.BUTTON_DISABLED_STYLE,\n      ...computedDisabledStyle,\n    }\n    return { autoDisable, disabledStyle }\n  }\n\n  static updateChildrenButtons(children, additionalProps = undefined) {\n    return deepMapWithIndex(children, n => {\n      if (n.type === Button) return this.updateButtons(n, additionalProps)\n      return n\n    })\n  }\n\n  static updateButtons(node, additionalProps) {\n    if (!additionalProps) additionalProps = {}\n    else {\n      additionalProps = {\n        disabled:\n          node.props.disabled === true\n            ? node.props.disabled\n            : additionalProps.disabled,\n        setDisabled: additionalProps.setDisabled,\n        parentId: additionalProps.parentId,\n      }\n    }\n    return {\n      ...node,\n      props: {\n        ...node.props,\n        ...additionalProps,\n      },\n    }\n  }\n\n  static getUpdatedMessage(messageToUpdate, { autoDisable, disabledStyle }) {\n    const updateMsgButton = button => {\n      return {\n        ...button,\n        ...{\n          disabled: true,\n        },\n      }\n    }\n    if (\n      isCarousel(messageToUpdate) &&\n      messageToUpdate.data &&\n      messageToUpdate.data.elements\n    ) {\n      messageToUpdate.data.elements = messageToUpdate.data.elements.map(e => ({\n        ...e,\n        ...{\n          buttons: e.buttons.map(updateMsgButton),\n        },\n      }))\n      return messageToUpdate\n    } else {\n      return {\n        ...messageToUpdate,\n        ...{\n          buttons: messageToUpdate.buttons.map(updateMsgButton),\n        },\n      }\n    }\n  }\n}\n"],"file":"buttons-disabler.js"}