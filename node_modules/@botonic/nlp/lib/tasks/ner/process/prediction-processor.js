"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PredictionProcessor = void 0;
var constants_1 = require("../../../preprocess/constants");
var constants_2 = require("./constants");
var PredictionProcessor = /** @class */ (function () {
    function PredictionProcessor(entities) {
        this.entities = entities;
    }
    PredictionProcessor.prototype.process = function (sequence, prediction) {
        var _this = this;
        var confidences = prediction.arraySync()[0];
        var entities = sequence.map(function (token, idx) {
            return _this.getEntity(token, confidences[idx]);
        });
        return entities.filter(function (e) { return e.text != constants_1.PADDING_TOKEN && e.label != constants_2.NEUTRAL_ENTITY; });
    };
    PredictionProcessor.prototype.getEntity = function (token, confidences) {
        var confidence = Math.max.apply(Math, confidences);
        var label = this.entities[confidences.indexOf(confidence)];
        var predictions = this.getPredictions(confidences);
        return { text: token, label: label, confidence: confidence, predictions: predictions };
    };
    PredictionProcessor.prototype.getPredictions = function (confidences) {
        var _this = this;
        return confidences.map(function (c, i) {
            return { label: _this.entities[i], confidence: c };
        });
    };
    return PredictionProcessor;
}());
exports.PredictionProcessor = PredictionProcessor;
//# sourceMappingURL=prediction-processor.js.map